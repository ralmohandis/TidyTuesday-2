---
   title: "Moore's Law"
   author: "Joel Soroos"
   date: "September 7, 2019"
   output: pdf_document
---


### 1. Source nuclear explosion data
```{r source, warning = TRUE, results = FALSE, message = FALSE}

   library (tidyverse)
   library (janitor) 

   cpu_raw <- read_csv("https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2019/2019-09-03/cpu.csv") %>%
      clean_names ()

   #remove scientific notation 
   options(scipen=999)
```
   

### 2a.  Build Moore's law predictor counts
```{r transform, message = F, results = F}

   moore <- tibble (
      year = as.numeric (seq (1971, 2020)),
      cpu_moore = ifelse (
         year > 1970, 
         round(2250 * sqrt(2) ^ (year - 1971),0),
         NA
         )
   )
```


### 2b.  Transform actual transistor counts
```{r transform, message = F, results = F}

   cpu_all <- cpu_raw %>%
      select(date_of_introduction, transistor_count) %>%
      rename (
         year = date_of_introduction,
         cpu_actual = transistor_count
         )

   cpu_max <- cpu_all %>%
      group_by (year) %>%
      summarize (
         cpu_actual = max(cpu_actual)
         )
```


### 2c.  Combine data
```{r transform, message = F, results = F}     
   
   combine <- moore %>%
      left_join (cpu_max) %>%
      select (year, cpu_moore, cpu_actual) %>%
      na.omit()

```

### 2d.  Calculate model line
```{r}

   library (broom)

   combine <- loess(		    
          log10(cpu_actual) ~ year,		   
          data = cpu_max,		       
          na.action = na.omit
          ) %>%		
       augment (combine) %>%
       mutate (fitted_exp = 10^.fitted)
   
   #https://github.com/amsteinkruger/tidytues/blob/master/moo/moo.Rmd
```


### 3. Visualize data
```{r plot}

   library (scales)
   library (ggdark)

   ggplot () +
      #Lines
         #Moore's law prediction
             geom_line(
                data = combine,
                aes (x=year, y = cpu_moore),
                size = 0.4, linetype = 3
                ) + 
            geom_line(
                data = cpu_loess,
                aes (x=year, y = fitted_exp),
                size = 0.7, linetype = 2
                ) + 
            geom_ribbon (
               data = combine,
               aes (x=year, ymin = cpu_moore, ymax = fitted_exp),
               fill = "red"
            ) +
      #Points
         geom_point(
            data = cpu_max,
            aes (x= year, y = cpu_actual),
            color = "gray22"
             ) +
      #Annotations
         #Moore's Law annotations
          annotate(
               geom="text", x=1977,y=200000,
               label="Moore's\nLaw", 
               color="#6D7C83", size=3, hjust=0.5,vjust=0.5, fontface="bold"
               ) +
            geom_curve(
               aes(x = 1977, xend = 1977, y = 70000, yend = 17000),
               arrow = arrow(length = unit(0.1, "inch")),
               size = 0.25, color = "#6D7C83", curvature = 0  
               ) +
         #Outperform annotations
            annotate(
               geom="text", 
               x=2000, xend = 2010, y=600000000, yend = 100000000,
               label="Over-predicted", 
               color="#6D7C83", size=3, hjust=0,vjust=0.5, fontface="bold", angle = 27
               ) +
         #Underperform annotations
            annotate(
               geom="text", 
               x=1990, xend = 2000, y=140000, yend = 1000000,
               label="Under-predicted", 
               color="#6D7C83", size=3, hjust=0,vjust=0.5, fontface="bold", angle = 27
               ) +
      #scales
         scale_y_continuous(
            trans = log10_trans(),
            breaks = c(2250, 10000, 100000, 1000000, 10000000, 100000000, 1000000000, 10000000000, 100000000000),
            labels = comma
            ) +
         scale_x_continuous(
            breaks = seq (1970, 2020, 10)
         ) +
      #themes
         dark_theme_classic () +
         theme(
            plot.title = element_text(hjust = 0, vjust = 0, size = 17, face = "bold", margin = margin (0,0,7,0)),
            plot.title.position = "plot",
            plot.subtitle = element_text(hjust = 0, vjust = 0, size = 8, face = "bold", margin = margin (0,0,30,0)),
            plot.caption = element_text (hjust = 0, size = 8, face = "plain", margin = margin (15,0,0,0), color="#6D7C83"),
            plot.caption.position = "plot",
            panel.grid.major = element_line(colour="white", size=0.03),
            axis.title.y = element_text (size = 9),
            axis.title.x = element_blank(),
            legend.position = "none"
            ) +
      labs(
         title = "Exponental growth in computing power",
         subtitle = "Gordon Moore predicted in 1971 that computing power would double approximately every 2 years (Moore's Law).  Over the next\n38 years proccessing strength has indeed grown at that rate.  Points signify microchip processor greater than predicted.",
         y = "Maximum transistors on a CPU microchip",
         caption = "Visualization: Joel Soroos @soroosj  |  Data: Wikipedia via R4DS Tidy Tuesday"
         ) +
      ggsave("moore.png", width = 22, height = 13, units = "cm")
```

