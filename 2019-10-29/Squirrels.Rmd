---
   title: "Squirrels"
   author: "Joel Soroos"
   date: "November 3, 2019"
   output: pdf_document
---


### 1. Source data
```{r source, warning = TRUE, results = FALSE, message = FALSE}

   library("ggmap")
   library("tidyverse")
   
   register_google(key = Sys.getenv("GOOGLE_MAPS_API"))
   
   squirrels_raw <- readr::read_csv("https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2019/2019-10-29/nyc_squirrels.csv")

```


### 2.  Transform data
```{r transform, message = F, results = F}

   squirrels <- squirrels_raw %>%
      pivot_longer (c(running:foraging, kuks:runs_from), "activity", "value") %>%
      select (long, lat, activity, value, age) %>%
      filter (value == T)


```



### 4. Visualize data
```{r}

   ggmap(
      get_googlemap(
         center = c("Central Park"),
         zoom = 13, 
         scale = 2,
         maptype ='roadmap',
         style = 'style=feature:poi|element:labels|visibility:off',
         color = 'color'
         )
      ) +
      geom_point(
         data = squirrels, 
         aes(x = long, y = lat),
         size = 0.05
         ) +
      scale_x_continuous(limits = c(-73.982, -73.95)) +
      scale_y_continuous(limits = c(40.765, 40.80)) +
      theme(axis.title.x=element_blank(),
         axis.text.x=element_blank(),
         axis.ticks.x=element_blank(),
         axis.title.y=element_blank(),
         axis.text.y=element_blank(),
         axis.ticks.y=element_blank(),
         legend.text=element_text(size=8),
         legend.title=element_blank(),
         legend.position="bottom"
         ) +
      facet_wrap (
         vars(activity),
         nrow = 3
         ) +
      ggsave("squirrels.png")
```