---
   title: "Commute"
   author: "Joel Soroos"
   date: "November 10, 2019"
   output: pdf_document
---


### 1. Source data
```{r source, warning = TRUE, results = FALSE, message = FALSE}

   library("tidyverse")
   library("ggmap")

   commute_raw <- readr::read_csv("https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2019/2019-11-05/commute.csv")
   
   map_borders <- map_data("usa") 


```


### 2.  Transform data
```{r transform, warning = T, message = F, results = F}

   library (glue)
   register_google(key = Sys.getenv("GOOGLE_MAPS_API"))

   commute <- commute_raw %>%
      filter (
         mode == "Bike",
         !state %in% c("Hawaii", "Alaska")
         ) %>%
      mutate (city_state = glue ("{city}, {state}"))
   
    commute_coord <- commute %>%
      #head (20) %>%
      mutate_geocode (city_state) %>%
      select (city, state, lon, lat, percent)
```


### 3. Visualize data
```{r visualize}

   library (ggdark)

   ggplot(commute, aes(x= lon, y = lat)) +
      geom_polygon (data = map_borders, aes(x = long, y = lat, group = group), color = "black", size = 1.15) +
      geom_point(
         aes (color = percent),
         size = 0.5
         ) +
      scale_color_gradient(low = "red", high = "darkgreen") +
      dark_mode(theme_minimal()) +
      theme(
         plot.title = element_text(hjust = 0, vjust = 0, size = 12, face = "bold", margin = margin (0,0,4,0)),
         plot.subtitle = element_text(hjust = 0, vjust = 0, size = 8, margin = margin (0,0,25,0)),
         plot.caption = element_text (hjust = 1, size = 8, face = "plain", margin = margin (10,0,0,0), color="#6D7C83"),
         axis.title=element_blank(),
         axis.text=element_blank(),
         axis.ticks=element_blank(),
         legend.title=element_blank()
         ) +
      labs(
         title = "Biking to Work in the United States: 2008â€“2012",
         caption = "Visualization: Joel Soroos @soroosj  |  Data: U.S. Census Bureau"
         ) +
      ggsave("commute.png", width = 14, height = 9, units = "cm")
```