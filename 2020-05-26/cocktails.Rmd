---
title: "Cocktails"
author: "Joel Soroos"
date: "5/26/2020"
output: html_document
---

### 1. Source data
```{r source, warning = TRUE, results = TRUE, message = FALSE}


   library(janitor)
   library(tidyverse)

   cocktails_raw <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2020/2020-05-26/boston_cocktails.csv')
    
```


### 2.  Exploratory data analysis
```{r transform, warning = TRUE, results = TRUE, message = FALSE}
   
   library (skimr)

   skim (cocktails_raw)
```


```{r}
   cocktails <- cocktails_raw %>%
      mutate (
         ingredient = case_when (
            ingredient == "Fresh lemon juice" ~ "Lemon Juice",
            ingredient == "Juice of a Lemon" ~ "Lemon Juice",
            ingredient == "Fresh Lime Juice" ~ "Lime Juice",
            ingredient == "Juice of a Lime" ~ "Lime Juice",
            TRUE ~ ingredient)
              ) %>%
      group_by (name) %>%
      count (ingredient, sort = T)

   top_ingredients = c ("Lemon Juice", "Simple Syrup", "Lime Juice", "Powdered Sugar", "Grenadine", "Egg White", "Pineapple Juice")

```


```{r}

   cocktails_list <- cocktails %>%
      group_by (name) %>%
      filter (ingredient %in% top_ingredients) %>%
      summarize(ingredient = list(ingredient))

```


```{r}
 
   library (ggupset)

   ggplot(cocktails_list, aes(x=ingredient)) +
      geom_bar() +
      scale_x_upset()
```
