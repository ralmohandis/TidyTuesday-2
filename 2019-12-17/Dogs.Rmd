---
   title: "Dogs"
   author: "Joel Soroos"
   date: "December 24, 2019"
   output: pdf_document
---


### 1. Source
```{r source, warning = TRUE, results = FALSE, message = FALSE}

   library("tidyverse")
   library("janitor")
   library("tidytuesdayR")

   tuesdata <- tidytuesdayR::tt_load('2019-12-17')
   dog_travel_raw <- tuesdata$dog_travel
   dog_descriptions_raw <- tuesdata$dog_descriptions
```


### 2.  Transform
```{r transform, warning = T, results = F, message = F}

   library (openintro)

   states <- tibble (
      state_name = state.name,
      state_abb = state.abb
      )

   dog_travel <- dog_travel_raw %>%
      rename (
         current_state = contact_state,
         prior_state = found
         ) %>%
      mutate (
         prior_state = ifelse (is.na (manual), prior_state, manual),
         prior_state = case_when (
            prior_state == "VA" ~ "Virginia",
            prior_state == "MD" ~ "Maryland",
            prior_state == "NC" ~ "North Carolina",
            prior_state == "LA" ~ "Louisiana",
            prior_state == "Charlotte" ~ "North Carolina",
            prior_state == "NM" ~ "New Mexico",
            prior_state == "NJ" ~ "New Jersey",
            TRUE ~ prior_state)
         ) %>%
      right_join (states, by = c("prior_state" = "state_name")) %>%
      select (current_state, state_abb, id) %>%
      rename (prior_state = state_abb) %>%
      group_by(current_state, prior_state) %>%
         count(prior_state, sort = T) 
```


### 3. Visualize
```{r visualize}

   library(circlize)

   library (showtext)
      font_add("Shlop", "shlop rg.ttf")
      showtext_auto() 

   ggplot (tickets_agg, aes(x=issue_time, y = n)) +
      geom_area (
         aes (fill = violation_desc),
         alpha = 0.85) +
      coord_polar() +
      #scales
         scale_x_continuous(
            breaks = seq (0,23,1),
            limits = c (0, 24)
            ) +
         scale_y_continuous(breaks = seq (0,20000,10000)) +
         scale_fill_brewer(type = "qual", palette = 1) +
      #themes
         dark_mode(theme_minimal()) +
         theme(
            plot.title = element_text(hjust = 0.5, vjust = 0, size = 30, face = "bold", color = "#CC1100", margin = margin (0,0,20,0)),
            plot.title.position = "plot",
            plot.caption = element_text (hjust = 0.5, size = 9, face = "plain", margin = margin (20,0,0,0)),
            plot.caption.position = "plot",
            axis.title = element_blank (),
            axis.line = element_blank (),
            axis.text.x = element_text(hjust = 0, vjust = 0, size = 15, margin = margin (0,0,0,0)),
            axis.text.y = element_blank (),
            axis.ticks = element_blank (),
            legend.title = element_blank(),
            legend.position = "bottom",
            panel.grid.major = element_line(color = "grey1", size = 1),
            panel.grid.minor.x = element_blank(),
            text = element_text(family = "Shlop", color = "#CC1100", face = "bold")
            ) +
      labs(
         title = "Philadephia Parking Violations",
         caption = "Each radian represents the hour in a 24 hour clock.\nEach concentric circle represents 10,000 parking violations per 10 minute period in 2017.\nVisualization: Joel Soroos @soroosj  |  Data: Open Data Philly via R4DS Tidy Tuesday"
         )
      ggsave("tickets.png", width = 4.9) 
```

```