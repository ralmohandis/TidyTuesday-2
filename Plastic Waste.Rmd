---
title: "Plastic Waste"
output:
  html_document: default
  author: Joel Soroos
---

### 1. Load packages
```{r setup, warning = FALSE, results = FALSE, message = FALSE}

   library (tidyverse)
   library (janitor)
   library (ggthemes)
   library (ggrepel)
   library (scales)
   library (countrycode)

```

### 2. Get data
```{r source, warning = TRUE, results = FALSE, message = FALSE}

waste_raw <- read_csv("https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2019/2019-05-21/per-capita-mismanaged-plastic-waste-vs-gdp-per-capita.csv") %>%
   clean_names()
   
```

### 3. Transform data
```{r transform}

waste <- waste_raw %>%
   rename (
      country_name = entity,
      country_code = code,
      waste_per_capita = per_capita_mismanaged_plastic_waste_kilograms_per_person_per_day,
      gdp_per_capita = gdp_per_capita_ppp_constant_2011_international_rate,
      population = total_population_gapminder
      )%>%
   select (country_name, waste_per_capita, gdp_per_capita, population) %>%
   arrange (country_name) %>%
   drop_na (waste_per_capita)

```


### 4. Create ridgeline chart by continent
```{r plot}

ggplot (waste,
   aes(x = gdp_per_capita, y = waste_per_capita, size = population)) +
   geom_point () +
   geom_smooth () +
   scale_x_continuous(
      trans = log10_trans(),
      labels = comma
      ) +
   scale_y_continuous(trans = log10_trans()) +
   geom_text_repel(
      aes (label = country_name),
      data = subset (waste, 
                     waste_per_capita > 0.17 |
                     waste_per_capita < .002 |
                     country_name == "India"
                     ),
      box.padding   = 0.5, 
      point.padding = 0.5,
      size = 3,
      segment.color = 'grey50') +
   theme_economist () +
   labs(
      title = "Mismanaged waste decreases as GDP increases (2010)",
      caption = "\n Source:National Geographic  |  R4DS Tidy Tuesday
      Visualization: Joel Soroos (Twitter: @soroosj)",
      x = "GDP per capita ($)",
      y = "Mismanaged Waste Per Capita (kg/day)") 

```
