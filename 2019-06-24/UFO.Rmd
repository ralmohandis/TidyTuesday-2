---
title: "UFO Sightings"
author: "Joel Soroos"
date: "June 27, 2019"
output: pdf_document
---

### 1. Source data
```{r source, warning = TRUE, results = FALSE, message = FALSE}

   library (tidyverse)
   library (janitor) 

   ufo_raw<- readr::read_csv("https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2019/2019-06-25/ufo_sightings.csv") %>%
      clean_names ()
   
   map_coordinates <- 
      map_data("state", region = NULL) %>%
      filter (region == "north carolina")  
   
```

### 2a.  Transform data
```{r transform, message = F}

  ufo <- ufo_raw %>%
      select (date_time, city_area, state, latitude, longitude, encounter_length) %>%
      filter (
         state == "nc",
         latitude > 30,
         latitude < 37,
         longitude < -75
         ) 
  
```

### 3. Visualize data
```{r plot}

   library (ggdark)

   ggplot () +
      geom_polygon (data = map_coordinates, aes(x = long, y = lat, group = group), color = "black", fill = "#303030", size = 1.15) +
      geom_point (data = ufo, aes (x = longitude, y = latitude, size = encounter_length), color = "red") +
      coord_fixed(1.3) +
      dark_mode(theme_minimal()) +
      scale_size_continuous(breaks = c(10, 100, 1000)) +
      theme (
          plot.title = element_text(hjust = 0, size = 15),
          plot.caption = element_text(hjust = 0, size = 9),
          legend.position = "bottom",
          axis.title = element_blank(),
          axis.ticks = element_blank(),
          axis.text = element_blank()

         ) +
      labs(
         title = "Open your wallet wide if you prefer red wine!",
         caption = "\nVertical line within violin represents median wine bottle price for that grape variety. \nSource: Wine Enthusiast via Kaggle via R4DS Tidy Tuesday       |       Visualization: Joel Soroos @soroosj"
         ) +
      ggsave("wine.png")
```
