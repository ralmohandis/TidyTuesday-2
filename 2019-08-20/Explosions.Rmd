---
   title: "Explosions"
   author: "Joel Soroos"
   date: "August 27, 2019"
   output: pdf_document
---

### 1a. Source nuclear explosion data
```{r source, warning = TRUE, results = FALSE, message = FALSE}

   library (tidyverse)
   library (janitor) 

   explosions_raw <- readr::read_csv("https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2019/2019-08-20/nuclear_explosions.csv") %>%
      clean_names ()
```
   

### 2.  Transform UFO data
```{r transform, message = F}

   explosions <- explosions_raw %>%
      #filter (year < 1975) %>%
      mutate (decade = floor(year / 10) * 10) %>%
      group_by (decade) %>%
      count (country) %>%
      mutate(rank = min_rank(-n) * 1) %>%
      ungroup ()
```

### 3. Visualize data
```{r plot}

   library (gganimate)
   library (gifski)
   library (png)

   g <- ggplot (explosions, aes (rank)) +
      geom_tile (aes(y = n/2, height = n), width = 0.9) +
      geom_text(aes(y = 0, label = paste(country, " ")), vjust = 0.2, hjust = 1) +
      coord_flip (clip = "off", expand = FALSE) +
      transition_states(decade, transition_length = 8, state_length = 6) +
      ease_aes('cubic-in-out') +
      scale_x_reverse() +
      labs(
         title = "Year : {closest_state}s"
       )
   
      animate(g, 24, fps = 5,  width = 800, height = 600, 
        renderer = gifski_renderer("explosions.gif"))
      
      #https://stackoverflow.com/questions/53162821/animated-sorted-bar-chart-with-bars-overtaking-each-other

```
